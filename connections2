{ "alias" : "connections", "title" : "Connections", "auth_required" : "1", "charts" : [ { "queries" : [ { "label" : "class=BRO_CONN icmp or tcp or udp", "query" : "class=BRO_CONN icmp or tcp or udp" } ], "y" : "1", "type" : "ColumnChart", "x" : "0", "options" : { "title" : "Connections by Time", "isStacked" : false, "width" : 1000, "legend" : "right", "animation" : { "duration" : 500 }, "vAxes" : [ { "title" : null, "maxValue" : null, "minValue" : null, "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null } }, { "minValue" : null, "maxValue" : null, "viewWindow" : { "min" : null, "max" : null }, "useFormatFromData" : true } ], "booleanRole" : "certainty", "hAxis" : { "minValue" : null, "maxValue" : null, "viewWindowMode" : null, "viewWindow" : null, "useFormatFromData" : true } } }, { "type" : "Doughnut", "queries" : [ { "label" : "class=BRO_CONN icmp or tcp or udp groupby:srcip", "query" : "class=BRO_CONN icmp or tcp or udp limit:3 groupby:srcip " } ], "y" : "2", "options" : { "vAxes" : [ { "maxValue" : null, "title" : null, "minValue" : null, "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true }, { "maxValue" : null, "minValue" : null, "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true } ], "hAxis" : { "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true, "minValue" : null, "maxValue" : null }, "booleanRole" : "certainty", "is3D" : false, "pieHole" : 0, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "width" : 453.333333333333, "title" : "Top SRC IPs" }, "x" : "0" }, { "y" : "3", "queries" : [ { "query" : "class=BRO_CONN +BRO_CONN.dstport=53 groupby:service", "label" : "class=BRO_CONN +BRO_CONN.dstport=53 groupby:service" } ], "type" : "Doughnut", "x" : "0", "options" : { "width" : 453.333333333333, "title" : "Top Port 53 Services", "hAxis" : { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "maxValue" : null, "minValue" : null }, "booleanRole" : "certainty", "vAxes" : [ { "title" : null, "maxValue" : null, "minValue" : null, "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null } }, { "minValue" : null, "maxValue" : null, "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null } } ], "pieHole" : 0, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "is3D" : false } }, { "x" : "1", "options" : { "title" : "Top Services", "width" : 453.333333333333, "is3D" : false, "pieHole" : 0, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "vAxes" : [ { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "maxValue" : null, "title" : null, "minValue" : null }, { "maxValue" : null, "minValue" : null, "viewWindow" : { "min" : null, "max" : null }, "useFormatFromData" : true } ], "booleanRole" : "certainty", "hAxis" : { "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true, "minValue" : null, "maxValue" : null } }, "queries" : [ { "query" : "class=BRO_CONN icmp or tcp or udp groupby:service", "label" : "class=BRO_CONN icmp or tcp or udp groupby:service" } ], "y" : "1", "type" : "Doughnut" }, { "x" : "1", "options" : { "title" : "Top DST IPs", "width" : 453.333333333333, "is3D" : false, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "pieHole" : 0, "vAxes" : [ { "maxValue" : null, "minValue" : null, "viewWindow" : { "min" : null, "max" : null }, "useFormatFromData" : true }, { "maxValue" : null, "minValue" : null, "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null } } ], "hAxis" : { "minValue" : null, "maxValue" : null, "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true }, "booleanRole" : "certainty" }, "queries" : [ { "query" : "class=BRO_CONN icmp or tcp or udp limit:3 groupby:srcip", "label" : "class=BRO_CONN icmp or tcp or udp groupby:srcip" } ], "y" : "2", "type" : "Doughnut" }, { "type" : "Doughnut", "y" : "3", "queries" : [ { "label" : "class=BRO_CONN +BRO_CONN.dstport=80 groupby:service", "query" : "class=BRO_CONN +BRO_CONN.dstport=80 groupby:service" } ], "options" : { "vAxes" : [ { "maxValue" : null, "title" : null, "minValue" : null, "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true }, { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "maxValue" : null, "minValue" : null } ], "booleanRole" : "certainty", "hAxis" : { "maxValue" : null, "minValue" : null, "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null } }, "is3D" : false, "pieHole" : 0, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "width" : 453.333333333333, "title" : "Top Port 80 Services" }, "x" : "1" }, { "x" : "2", "options" : { "width" : 453.333333333333, "title" : "Top DST Ports", "booleanRole" : "certainty", "hAxis" : { "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null }, "maxValue" : null, "minValue" : null }, "vAxes" : [ { "minValue" : null, "maxValue" : null, "title" : null, "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true }, { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "maxValue" : null, "minValue" : null } ], "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "pieHole" : 0, "is3D" : false }, "y" : "2", "queries" : [ { "label" : "class=BRO_CONN icmp or tcp or udp groupby:dstport", "query" : "class=BRO_CONN icmp or tcp or udp limit:2 groupby:dstport" } ], "type" : "Doughnut" }, { "type" : "Doughnut", "y" : "3", "queries" : [ { "label" : "class=BRO_CONN +BRO_CONN.dstport=443 groupby:service", "query" : "class=BRO_CONN +BRO_CONN.dstport=443 groupby:service" } ], "options" : { "title" : "Top Port 443 Services", "width" : 453.333333333333, "is3D" : false, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "pieHole" : 0, "vAxes" : [ { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "maxValue" : null, "title" : null, "minValue" : null }, { "minValue" : null, "maxValue" : null, "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null } } ], "hAxis" : { "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true, "maxValue" : null, "minValue" : null }, "booleanRole" : "certainty" }, "x" : "2" }, { "queries" : [ { "label" : "", "query" : "class=BRO_HTTP groupby:site | grep(.,[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}) | filter(.,192.168.[0-9]{1,3}.[0-9]{1,3}|10.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}|172.1[6-9]{1}.[0-9]{1,3}.[0-9]{1,3}|172.2[0-9]{1}.[0-9]{1,3}.[0-9]{1,3}|172.3[0-2]{1}.[0-9]{1,3}.[0-9]{1,3}|2[2-5]{1}[0-9]{1}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3})" } ], "y" : "2", "type" : "Doughnut", "x" : "3", "options" : { "width" : 680, "title" : "Direct to IP Outbound Connections" } }, { "queries" : [ { "label" : "POSTs to Non-US Sites", "query" : "method=POST referer=\\\"-\\\" groupby:site | subsearch(class:bro_http groupby:dstip) | whois | filter(.,us|US|MyOrg)" } ], "y" : "3", "type" : "Doughnut", "x" : "3", "options" : { "title" : "POSTs to Non-US Sites" } } ] }
