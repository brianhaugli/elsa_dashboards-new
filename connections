{ "title" : "Connections", "charts" : [ { "type" : "ColumnChart", "queries" : [ { "query" : "class=BRO_CONN icmp or tcp or udp", "label" : "class=BRO_CONN icmp or tcp or udp" } ], "y" : "1", "x" : "0", "options" : { "booleanRole" : "certainty", "title" : "Connections by Time", "legend" : "right", "animation" : { "duration" : 500 }, "width" : 1000, "hAxis" : { "viewWindowMode" : null, "minValue" : null, "maxValue" : null, "viewWindow" : null, "useFormatFromData" : true }, "vAxes" : [ { "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null }, "minValue" : null, "maxValue" : null, "title" : null }, { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "maxValue" : null, "minValue" : null } ], "isStacked" : false } }, { "y" : "2", "queries" : [ { "label" : "class=BRO_CONN icmp or tcp or udp groupby:srcip", "query" : "class=BRO_CONN icmp or tcp or udp groupby:srcip" } ], "type" : "PieChart", "options" : { "title" : "Top SRC IPs", "is3D" : false, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "booleanRole" : "certainty", "vAxes" : [ { "minValue" : null, "maxValue" : null, "title" : null, "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null } }, { "minValue" : null, "maxValue" : null, "viewWindow" : { "min" : null, "max" : null }, "useFormatFromData" : true } ], "width" : "333.333333333333", "pieHole" : 0, "hAxis" : { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "minValue" : null, "maxValue" : null } }, "x" : "0" }, { "options" : { "pieHole" : 0, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "booleanRole" : "certainty", "hAxis" : { "minValue" : null, "maxValue" : null, "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null } }, "title" : "Top Services", "vAxes" : [ { "minValue" : null, "maxValue" : null, "title" : null, "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true }, { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "minValue" : null, "maxValue" : null } ], "is3D" : false }, "x" : "0", "y" : "3", "type" : "PieChart", "queries" : [ { "label" : "class=BRO_CONN icmp or tcp or udp groupby:service", "query" : "class=BRO_CONN icmp or tcp or udp groupby:service" } ] }, { "x" : "0", "options" : { "title" : "Top Port 80 Services", "vAxes" : [ { "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null }, "title" : null, "maxValue" : null, "minValue" : null }, { "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true, "minValue" : null, "maxValue" : null } ], "is3D" : false, "pieHole" : 0, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "booleanRole" : "certainty", "hAxis" : { "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true, "minValue" : null, "maxValue" : null } }, "type" : "PieChart", "queries" : [ { "query" : "class=BRO_CONN +BRO_CONN.dstport=80 groupby:service", "label" : "class=BRO_CONN +BRO_CONN.dstport=80 groupby:service" } ], "y" : "4" }, { "options" : { "width" : "333.333333333333", "pieHole" : 0, "hAxis" : { "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true, "minValue" : null, "maxValue" : null }, "vAxes" : [ { "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null }, "minValue" : null, "maxValue" : null }, { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "minValue" : null, "maxValue" : null } ], "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "booleanRole" : "certainty", "title" : "Top DST IPs", "is3D" : false }, "x" : "1", "y" : "2", "type" : "PieChart", "queries" : [ { "query" : "class=BRO_CONN icmp or tcp or udp groupby:srcip", "label" : "class=BRO_CONN icmp or tcp or udp groupby:srcip" } ] }, { "queries" : [ { "label" : "class=BRO_CONN +BRO_CONN.dstport=53 groupby:service", "query" : "class=BRO_CONN +BRO_CONN.dstport=53 groupby:service" } ], "type" : "PieChart", "y" : "3", "x" : "1", "options" : { "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "pieHole" : 0, "hAxis" : { "maxValue" : null, "minValue" : null, "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null } }, "booleanRole" : "certainty", "title" : "Top Port 53 Services", "vAxes" : [ { "maxValue" : null, "minValue" : null, "title" : null, "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null } }, { "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null }, "minValue" : null, "maxValue" : null } ], "is3D" : false } }, { "options" : { "is3D" : false, "title" : "Top Port 443 Services", "vAxes" : [ { "title" : null, "minValue" : null, "maxValue" : null, "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null } }, { "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null }, "maxValue" : null, "minValue" : null } ], "booleanRole" : "certainty", "hAxis" : { "maxValue" : null, "minValue" : null, "useFormatFromData" : true, "viewWindow" : { "max" : null, "min" : null } }, "pieHole" : 0, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ] }, "x" : "1", "y" : "4", "type" : "PieChart", "queries" : [ { "label" : "class=BRO_CONN +BRO_CONN.dstport=443 groupby:service", "query" : "class=BRO_CONN +BRO_CONN.dstport=443 groupby:service" } ] }, { "options" : { "booleanRole" : "certainty", "hAxis" : { "maxValue" : null, "minValue" : null, "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null } }, "pieHole" : 0, "colors" : [ "#3366CC", "#DC3912", "#FF9900", "#109618", "#990099", "#0099C6", "#DD4477", "#66AA00", "#B82E2E", "#316395", "#994499", "#22AA99", "#AAAA11", "#6633CC", "#E67300", "#8B0707", "#651067", "#329262", "#5574A6", "#3B3EAC", "#B77322", "#16D620", "#B91383", "#F4359E", "#9C5935", "#A9C413", "#2A778D", "#668D1C", "#BEA413", "#0C5922", "#743411" ], "is3D" : false, "vAxes" : [ { "title" : null, "minValue" : null, "maxValue" : null, "useFormatFromData" : true, "viewWindow" : { "min" : null, "max" : null } }, { "maxValue" : null, "minValue" : null, "viewWindow" : { "max" : null, "min" : null }, "useFormatFromData" : true } ], "title" : "Top DST Ports" }, "x" : "2", "y" : "2", "type" : "PieChart", "queries" : [ { "label" : "class=BRO_CONN icmp or tcp or udp groupby:dstport", "query" : "class=BRO_CONN icmp or tcp or udp groupby:dstport" } ] }, { "options" : { "width" : 680, "title" : "Direct to IP Outbound Connections" }, "x" : "2", "y" : "3", "queries" : [ { "label" : "", "query" : "class=BRO_HTTP groupby:site | grep(.,[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}) | filter(.,192.168.[0-9]{1,3}.[0-9]{1,3}|10.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}|172.1[6-9]{1}.[0-9]{1,3}.[0-9]{1,3}|172.2[0-9]{1}.[0-9]{1,3}.[0-9]{1,3}|172.3[0-2]{1}.[0-9]{1,3}.[0-9]{1,3}|2[2-5]{1}[0-9]{1}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3})" } ], "type" : "Doughnut" }, { "options" : { "title" : "POSTs to Non-US Sites" }, "x" : "2", "y" : "4", "queries" : [ { "query" : "method=POST referer=\\\"-\\\" groupby:site | subsearch(class:bro_http groupby:dstip) | whois | filter(.,us|US|MyOrg)", "label" : "POSTs to Non-US Sites" } ], "type" : "Doughnut" } ], "alias" : "connections", "auth_required" : "1" }
